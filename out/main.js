"use strict";var w=Object.create;var d=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var D=(t,e)=>{for(var n in e)d(t,n,{get:e[n],enumerable:!0})},g=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of x(e))!P.call(t,i)&&i!==n&&d(t,i,{get:()=>e[i],enumerable:!(s=v(e,i))||s.enumerable});return t};var p=(t,e,n)=>(n=t!=null?w(y(t)):{},g(e||!t||!t.__esModule?d(n,"default",{value:t,enumerable:!0}):n,t)),S=t=>g(d({},"__esModule",{value:!0}),t);var E={};D(E,{activate:()=>k,deactivate:()=>K});module.exports=S(E);var o=p(require("vscode")),m=p(require("fs"));var h=p(require("fs")),u=p(require("path")),l=class{static{this.cachedKeywords=null}static getKeywords(e){if(this.cachedKeywords)return this.cachedKeywords;try{let n=u.join(e,"syntaxes","feature.tmLanguage.json"),r=JSON.parse(h.readFileSync(n,"utf8")).repository.step_keyword.match.match(/\((.*)\)/)[1];return this.cachedKeywords=r,r}catch{return"Given|When|Then|And|But"}}static extractRegex(e,n){let s=this.getKeywords(n),i=new RegExp(`\\[(?:${s})\\s*\\(@"(.*)"\\)\\]`,"i"),r=e.match(i);return r?r[1]:null}static isMatch(e,n,s){try{let i=this.getKeywords(s),r=new RegExp(`^\\s*(${i})\\s+`,"i"),c=e.replace(r,""),a=n.replace(/""/g,'"');return new RegExp(`^${a}$`).test(c)}catch{return!1}}};function k(t){console.log("Gherkin Step Navigator is now active.");let e=o.languages.registerDefinitionProvider({language:"gherkin",scheme:"file"},{async provideDefinition(n,s){let i=n.lineAt(s.line).text,r=await R(t);for(let c of r)if(l.isMatch(i,c.pattern,t.extensionPath)){let a=o.Uri.file(c.file),f=new o.Range(new o.Position(c.line,0),new o.Position(c.line,0));return new o.Location(a,f)}return[]}});t.subscriptions.push(e)}async function R(t){let e=[],n=await o.workspace.findFiles("**/*.cs","**/node_modules/**");for(let s of n)try{m.readFileSync(s.fsPath,"utf8").split(/\r?\n/).forEach((c,a)=>{let f=l.extractRegex(c,t.extensionPath);f&&e.push({pattern:f,line:a,file:s.fsPath})})}catch(i){console.error(`Failed to read file ${s.fsPath}:`,i)}return e}function K(){}0&&(module.exports={activate,deactivate});
